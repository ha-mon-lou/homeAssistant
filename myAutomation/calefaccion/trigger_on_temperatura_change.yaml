#
# https://homeassistant-notes.notion.site/Proyecto-climatizaci-n-1819be0e2c17803f8c00e7a4696264e7
#

- id: "trigger_on_temperatura_change"
  alias: Ajustar termostato segÃºn la TRV con mayor temperatura
  triggers:
    - trigger: state
      entity_id: sensor.temperatura_objetivo_max
    - trigger: state
      entity_id: sensor.temperatura_caldera
  conditions: []
  actions:
    - sequence:
        - action: script.control_calefaccion
          data:
            mode: "{{ 'heat' if (states('sensor.temperatura_objetivo_max') | float(0)) > (states('sensor.temperatura_caldera') | float(0)) else 'off'}}"
            temperatura: "{{ states('sensor.temperatura_objetivo_max') | float (0) }}"
  mode: single
